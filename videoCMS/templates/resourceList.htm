<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>{{title}}  资源列表</title>
<link href="/static/css/channelList.css" rel="stylesheet" type="text/css" />
<link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="/static/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
<link href="/static/css/icheck-square/purple.css" rel="stylesheet" type="text/css" />
<link href="/static/css/icheck-square/aero.css" rel="stylesheet" type="text/css" />
<link href="/static/css/icheck-square/blue.css" rel="stylesheet" type="text/css" />
<link href="/static/css/icheck-square/red.css" rel="stylesheet" type="text/css" />
<link href="/static/css/icheck-square/green.css" rel="stylesheet" type="text/css" />
<link href="/static/css/common.css" rel="stylesheet" type="text/css" />


<script src="/static/js/jquery.min.1.8.3.cdn.js"></script>
<script src="/static/js/icheck.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/bootstrap-datetimepicker.min.js"></script>
<script src="/static/js/common.js"></script>
<script src="/static/js/resourceList.js"></script>

<script type="text/javascript">
    var singleReview = {% if singleReview %}true{% else %}false{% endif %};
</script>
</head>
<body style="background-color:#CCC;">
    {% include "nav.htm" %}
    <div class="container">
        <div class="row-fluid">
            <div class="span8 paddingWrap" style="background-color:#FFF;">
			            {%for resource in resourceList%}
			            <div class="row-fluid topicItem">
		                    <div class="topicImage">		                    	
		                    	<div style="position:absolute;">
                                    <span class="label label-inverse">{{ resource.videoType }}</span>
		                    	</div>
		                        <img class="resourceImage" src="{{resource.resourceImageUrl}}" />
                                <div class="bigResourceImage" >
                                    <span class="resolution" style=" ">
                                        {{ resource.v_size }}，{{ resource.v_br }}kbs，
                                        大小：{{ resource.resourceSize }}KB，时长：{{ resource.duration }}S，码率：{{ resource.br }} KB/S
                                    </span>
                                    <img src="{{resource.resourceImageUrlOri}}"/>
                                </div>
		                    </div>
		                    <div class="span9 topicItemRight">
		                        <div class="row-fluid">
                                    <a class="label label-primary" href="/channel/index?channelId={{resource.channelId}}">{{resource.channelName}} {{resource.channelId}}</a>
                                    <span class="label label-success">
                                        {% ifequal resource.source "manual" %}人工{% endifequal %}
                                        {% ifequal resource.source "spider" %}自动{% endifequal %}
                                        {% ifequal resource.source "weibo" %}微博{% endifequal %}
                                        {% ifequal resource.source "recommend" %}推荐{% endifequal %}
                                    </span> &nbsp;
                                    <span class="label label-info">播{{resource.playNumber}}/下{{resource.downloadNumber}}</span>
		                            {% if resource.isOnline%}
		                            <a href="#" resourceId="{{resource.id}}" class="label label-warning" onclick="toggleOnlineStatus(this)">在线</a>
		                            {% else %}
		                            <a href="#" resourceId="{{resource.id}}" class="label"  onclick="toggleOnlineStatus(this)">下线</a>
		                        	{% endif %}
                                    <a target="_blank" class="label label-warning" href="showJson?id={{resource.id}}">JSON</a>


                                    {% ifequal resource.type "gif" %}
		                        	<a href="/resourceGif/update?id={{resource.id}}" class="label label-warning" target="_blank">编辑</a>
                                    {% else %}
                                    <a href="update?id={{resource.id}}" class="label label-warning" target="_blank">编辑</a>
                                    {% endifequal %}



                                    <!-- 操作下拉菜单 -->
                                    <div class="btn-group" style="display: inline-block;">
                                        <a class="btn dropdown-toggle btn-mini" data-toggle="dropdown" href="#">操作<span class="caret"></span></a>
                                        <ul class="dropdown-menu">
                                            <li><a  onclick="addToBaBa(this,'{{ resource.id }}')">+Baba视频</a></li>
                                            <li><a resourceId="{{resource.id}}" onclick="refreshSnapshot(this)">更新截图</a></li>
                                            <li><a resourceId="{{resource.id}}" onclick="stopSnapshot(this)">取消截图</a></li>
                                            <li><a resourceId="{{resource.id}}" onclick="setTobeReview(this)">提交待审</a></li>

                                            {%ifequal role "admin"%}
                                            <li><a onclick="pushResource('{{resource.id}}','{{resource.resourceName}}')">Push</a></li>
                                            <li><a onclick="deleteResource('{{resource.id}}')">删除</a></li>
                                            {%endifequal%}
                                            <li></li>
                                        </ul>
                                    </div>

                                    <br/>
                                    <a href="{{resource.resourceUrl}}">{{resource.resourceName}}</a>

		                        </div>

                                <ul class="nav nav-tabs" style="margin-top: 10px;">
                                    <li class="active"><a href="#{{ resource.id }}_1" data-toggle="tab">时间</a></li>
                                    <li>
                                        <a href="#{{ resource.id }}_2" data-toggle="tab">
                                            截图/预览
                                            {%  ifequal resource.snapshot "done"  %}<i class="icon-ok"></i>{%  endifequal  %}
                                            {%  ifequal resource.snapshot "pending"  %}<i class="icon-time"></i>{%  endifequal  %}
                                            {%  ifequal resource.snapshot "error" %} <i class="icon-warning-sign"></i>{%  endifequal  %}
                                            {%  ifequal resource.snapshot "small" %} <i class="icon-resize-small"></i>{%  endifequal  %}
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#{{ resource.id }}_3" data-toggle="tab">标签</a>
                                    </li>
                                </ul>

                                <div class="tab-content">
                                    <div class="tab-pane active" id="{{ resource.id }}_1">
                                        <div class="row-fluid smallFont">
                                            <div class="span6">创建日期:{{resource.createTime}}</div>
                                            <div class="span6">updateTime:{{resource.updateTime}}</div>
                                        </div>
                                        <div class="row-fluid smallFont">
                                            <div class="span6">定时上线:{{resource.scheduleGoOnline}}</div>
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="{{ resource.id }}_2">

                                        <div class="row-fluid smallFont">
                                            截图状态：<a href="#" title="{{resource.snapshotMsg}}" >{{resource.snapshot}}</a>
                                            <a target="_blank" href="/resource/getVideoUrl?videoType={{resource.videoType}}&videoId={{resource.videoId}}" class="label label-warning">检测视频地址</a>
                                            <a target="_blank" href="/video/play?videoType={{resource.videoType}}&videoId={{resource.videoId}}" class="label label-warning" >预览</a>

                                            {% if resource.validTime%}
                                            <div class="span12">
                                                <span class="label {%ifequal resource.invalidMsg 'client' %} {%else%} label-important{%endifequal%} "  title="{{resource.invalidMsg}}">失效日期:{{resource.validTime}}</span>
                                                <a class="label label-important" onclick="unsetInvalid(this,'{{resource.id}}')">取消失效</a>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="{{ resource.id }}_3">
                                        {% for tag in resource.tagList %}
                                            {{ tag }}
                                        {% endfor %}
                                    </div>

                                </div>


		                    </div>
                            {% if review %}
                            <div style="width:60px;float: left;">
                                <div>
                                    <input id="to_{{ resource.id }}" type="radio" review="0" name="review_{{ resource.id }}" {% ifequal resource.review 0 %}checked="checked"{% endifequal %} />
                                    <label for="to_{{ resource.id }}">待审</label><br/><br/>
                                </div>
                                <div>
                                    <input id="ac_{{ resource.id }}" type="radio" review="1" name="review_{{ resource.id }}" {% ifequal resource.review 1 %}checked="checked"{% endifequal %} />
                                    <label for="ac_{{ resource.id }}">通过</label><br/><br/>
                                </div>
                                <div class="rejectItem">
                                    <input id="rj_{{ resource.id }}" type="radio" review="-1" name="review_{{ resource.id }}" {% ifequal resource.review -1 %}checked="checked"{% endifequal %}/>
                                    <label for="rj_{{ resource.id }}">不过</label>
                                    <div class="rejectReason">
                                        <input type="radio" id="reject_{{ forloop.counter }}_0" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_0">0 地址/截图失效</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_1" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_1">1 截图无事件主体</label><br/>

                                        <input type="radio" id="reject_{{ forloop.counter }}_{{ forloop.counter1 }}_2" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_2">2 截图不高请</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_3" name="rejectReason" value=""/>
                                        <label for="rejec_{{ forloop.counter }}t_3">3 截图黑边</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_4" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_4">4 截图小（可做拼图）</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_5" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_5">5 截图与标题无关</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_6" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_6">6 截图太暗</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_7" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_7">7 标题格式不规范</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_8" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_8">8 标题无重点</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_9" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_9">9 推荐理由无吸引力</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_10" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_10">10 标点符号过多</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_11" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_11">11 描述与标题重复</label><br/>
                                        <input type="radio" id="reject_{{ forloop.counter }}_12" name="rejectReason" value=""/>
                                        <label for="reject_{{ forloop.counter }}_12">12 其他</label><br/>
                                        <textarea name="customReason" rows="3" cols="8"></textarea>
                                        <button onclick="rejectWithReason('{{ resource.id }}',this)">确定</button>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
		                </div>
			            {%endfor%}
                        <div style="height: 300px;"></div>
			</div>
			
			<div class="span4" >
                <form id="form_nav">
                <!--<input type="hidden" name="review" value="{{ review }}"/>-->
                {% ifequal role "admin"%}
                <div class="edit-mode">
                    <div class="edit-mode-item {% if not review %}selected{% endif %}" onclick="changeMode('')" >
                        普通模式
                    </div>
                    <div class="edit-mode-item {% if review %}selected{% endif %}" onclick="changeMode('待审核')">
                        审核模式
                    </div>
                </div>

                {% if review %}
                <div class="review-status">
                    <div class="review-status-item " >
                        <input id="onReview" type="radio" name="_rr" value="待审核"  {% ifequal review "待审核" %} checked="checked"{% endifequal %}  /> &nbsp;
                        <label for="onReview" >待审核</label>
                    </div>
                    <div class="review-status-item" >
                        <input id="ReviewReject" type="radio" name="_rr" value="审核悲剧" {% ifequal review "审核悲剧" %} checked="checked"{% endifequal %} />&nbsp;
                        <label for="ReviewReject">审核悲剧</label>
                    </div>
                </div>
                {% if not singleReview %}
                <div class="batch-operation">
                    <div class="batch-operation-item" onclick="pendAll()">
                        全部待审
                    </div>
                    <div class="batch-operation-item" onclick="acceptAll()">
                        全部通过
                    </div>
                    <div class="batch-operation-item" onclick="rejectAll()">
                        全部不过
                    </div>
                </div>

                <div class="batch-operation">
                    <div class="batch-operation-save" onclick="batch_review()">
                        保存
                    </div>
                </div>
                {% endif %}
                {% endif %}

                {% endifequal %}
                <input type="hidden" name="review" value="{{ review }}"/>

                <div class="paddingWrap" style="background-color:#FFF;">

                    <div id="nav_div">
                    <table>
                        <tr>
                            <td>资源名称</td>
                            <td><input name="name" type="text" style="width:110px" value="{{name}}"/></td>
                            <td rowspan="3"><input class="btn btn-inverse btn-mini" type="submit" value="搜索" /></td>
                        </tr>
                        <tr>
                            <td>资源ID</td>
                            <td><input name="id" type="text" style="width:110px" value="{{id}}"/></td>
                        </tr>

                        <tr>
                            <td>频道ID</td>
                            <td><input name="channelId" type="text" style="width:110px" value="{{channelId}}"/></td>
                        </tr>
                        <tr>
                            <td>videoType</td>
                            <td><input name="videoType" type="text" style="width:110px" value="{{videoType}}"/></td>
                        </tr>
                        <tr>
                            <td>videoId</td>
                            <td><input name="videoId" type="text" style="width:110px" value="{{videoId}}"/></td>
                        </tr>
                        <tr>
                            <td>类别</td>
                            <td>
                                <select name="channelType"  style="width:110px">
                                {%for one in typeList%}
                                    <option {%ifequal one channelType %}selected{%endifequal%}>{{one}}</option>
                                {%endfor%}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>编辑ID</td>
                            <td>
                                <input name="editor" type="text" style="width:60px" value="{{editor}}"/>&nbsp;
                                <input style="margin: 0px;" type="checkbox" name="editorExists" {% if editorExists %}checked="checked" {% endif %} value="1" /> &nbsp;非空
                            </td>
                            <td>

                            </td>
                        </tr>
                        <tr>
                            <td>mongo</td>
                            <td><textarea name="mongo" type="text" style="width:110px;height:110px;">{{mongo}}</textarea></td>
                        </tr>
                        <tr>
                            <td>在线</td>
                            <td>
                                <input type="radio" name="isOnline" value="all" {%ifequal isOnline "all" %}checked="checked" {%endifequal%} />全部
                                <input type="radio" name="isOnline" value="true" {%ifequal isOnline "true" %}checked="checked" {%endifequal%} />在线
                                <input type="radio" name="isOnline" value="false" {%ifequal isOnline "false" %}checked="checked" {%endifequal%} />不在线
                            </td>
                        </tr>
                        <tr>
                            <td>时间段</td>
                            <td>
                                <input type="text" name="startTime" value="{{startTime}}"  style="width:110px"/>至<br/>
                                <input type="text" name="endTime" value="{{endTime}}" style="width:110px"/>
                            </td>
                        </tr>
                        <tr>
                            <td>来源</td>
                            <td>
                                <input type="radio" name="source" value=""  {%ifequal source "" %}checked="checked" {%endifequal%}/>全部
                                <input type="radio" name="source" value="manual"  {%ifequal source "manual" %}checked="checked" {%endifequal%}/>人工

                                <input type="radio" name="source" value="spider"  {%ifequal source "spider" %}checked="checked" {%endifequal%}/>自动
                                <br/>
                                <input type="radio" name="source" value="weibo"  {%ifequal source "weibo" %}checked="checked" {%endifequal%}/>微博

                                <input type="radio" name="source" value="recommend"  {%ifequal source "recommend" %}checked="checked" {%endifequal%}/>推荐

                            </td>
                        </tr>
                        <tr>
                            <td>排序</td>
                            <td>
                                <input type="radio" name="sort" value=""  {%ifequal sort "" %}checked="checked" {%endifequal%}/>默认
                                <input type="radio" name="sort" value="updateTime"  {%ifequal sort "updateTime" %}checked="checked" {%endifequal%}/>更新

                                <input type="radio" name="sort" value="createTime"  {%ifequal sort "createTime" %}checked="checked" {%endifequal%}/>创建
                                <br/>
                                <input type="radio" name="sort" value="weight" {%ifequal sort "weight" %}checked="checked" {%endifequal%}/>权重
                                <input type="radio" name="sort" value="playNumber" {%ifequal sort "playNumber" %}checked="checked" {%endifequal%}/>播放
                                <input type="radio" name="sort" value="downloadNumber" {%ifequal sort "downloadNumber" %}checked="checked" {%endifequal%}/>下载
                                <br/>
                                <input type="radio" name="sort" value="invalidTime" {%ifequal sort "invalidTime" %}checked="checked" {%endifequal%}/>失效
                                <input type="radio" name="sort" value="updateTimeAsc" {%ifequal sort "updateTimeAsc" %}checked="checked" {%endifequal%}/>更升
                            </td>
                        </tr>
                        <tr>
                            <td>第<input type="text" name="page" value="{{page}}"/>页</td>
                            <td>每页<input type="text" name="len" value="{{len}}"/>条/({{findNum}})</td>
                            <td><input class="btn btn-inverse btn-mini" type="submit" value="转到"/></td>
                        </tr>
                        <tr>
                            <td><a onclick="goPage(1)" >首页</a></td>
                            <td><a onclick="goPage({{prePage}})">上一页</a></td>
                            <td><a onclick="goPage({{nextPage}})">下一页</a></td>
                        </tr>
                    </table>
                    </div>

              </div>
              </form>
            </div>
		</div>
	</div>
<!-- Modal -->
<form action="/resource/pushResource">
    <div id="pushModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">发送Push</h3>
      </div>
      <div class="modal-body">
        <p>视频：<span id="pushResourceName"></span></p>
        <input name="pushResourceId" type="text" />
        <p>内容:</p>
        <input name="pushTitle" type="text" style="width: 350px;"/><br/>
        <textarea name="pushContent" style="width: 350px;height: 120px;"></textarea><br/>

        <div id="datetimepicker1" class="input-append">
            定时发送:
            <input data-format="yyyy/MM/dd hh:mm:ss" name="cronTime" type="text" />
            <span class="add-on">
                <i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
            </span>(立即发送请留空)
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
        <button class="btn btn-primary">发送</button>
      </div>
    </div>
</form>
</body>
</html>
